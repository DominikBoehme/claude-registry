<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude-Projekt Registry</title>
    <style>
        @import url("https://www.static-immobilienscout24.de/fro/make-it-sans/1001/makeitsans.css");
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Make It Sans", Arial, sans-serif;
            background-color: #FFFFFF;
            color: #333333;
            line-height: 1.5;
        }
        
        .main-container {
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }
        
        .logo-section {
            width: 100%;
            padding: 24px 60px 0 60px;
            display: flex;
            justify-content: flex-end;
        }
        
        .title-section {
            width: 100%;
            padding: 24px 60px;
            background-color: transparent;
        }
        
        .title-section h1 {
            font-size: 34px;
            line-height: 44px;
            font-weight: bold;
            color: #333333;
            text-align: left;
            margin-bottom: 8px;
        }
        
        .title-section p {
            font-size: 15px;
            color: #676767;
            line-height: 25px;
        }
        
        .content-section {
            width: 100%;
            padding: 0 60px 60px 60px;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }
        
        .four-column-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }
        
        .card {
            background-color: #FFFFFF;
            border: 1px solid #EAEAEA;
            border-radius: 6px;
            padding: 30px;
        }
        
        .card-teal {
            background-color: #00FFD0;
            border: 1px solid #EAEAEA;
            border-radius: 6px;
            padding: 30px;
        }
        
        .card-yellow {
            background-color: #F5F200;
            border: 1px solid #EAEAEA;
            border-radius: 6px;
            padding: 30px;
        }
        
        .card-blue {
            background-color: #00DFFF;
            border: 1px solid #EAEAEA;
            border-radius: 6px;
            padding: 30px;
        }
        
        .card-orange {
            background-color: #FF9015;
            border: 1px solid #EAEAEA;
            border-radius: 6px;
            padding: 30px;
        }
        
        h2 {
            font-size: 26px;
            line-height: 36px;
            font-weight: bold;
            color: #333333;
            margin-bottom: 16px;
        }
        
        h3 {
            font-size: 20px;
            line-height: 30px;
            font-weight: bold;
            color: #333333;
            margin-bottom: 16px;
        }
        
        h4 {
            font-size: 18px;
            line-height: 28px;
            font-weight: bold;
            color: #333333;
            margin-bottom: 4px;
        }
        
        p {
            font-size: 15px;
            line-height: 25px;
            color: #333333;
            margin-bottom: 16px;
        }
        
        .project-list {
            list-style: none;
        }
        
        .project-item {
            padding: 16px 0;
            border-bottom: 1px solid #EAEAEA;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            transition: background-color 0.2s ease;
        }
        
        .project-item[style*="cursor: pointer"]:hover {
            background-color: #F5F5F5;
            padding-left: 12px;
            padding-right: 12px;
            margin-left: -12px;
            margin-right: -12px;
            border-radius: 6px;
        }
        
        .project-item:last-child {
            border-bottom: none;
        }
        
        .project-info p {
            font-size: 14px;
            color: #676767;
            line-height: 22px;
            margin-bottom: 0;
        }
        
        .project-owner {
            font-size: 12px;
            color: #333333;
            background: #F5F5F5;
            padding: 4px 8px;
            border-radius: 4px;
            white-space: nowrap;
            margin-left: 16px;
        }
        
        .stat-number {
            font-size: 26px;
            font-weight: bold;
            color: #333333;
            margin-bottom: 4px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 12px;
            color: #676767;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-align: center;
        }
        
        .search-box {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .search-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #EAEAEA;
            border-radius: 6px;
            font-size: 15px;
            font-family: "Make It Sans", Arial, sans-serif;
            color: #333333;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #333333;
        }
        
        .btn {
            padding: 8px 12px;
            border-radius: 999px;
            font-size: 14px;
            font-weight: bold;
            border: 1px solid #EAEAEA;
            background-color: #FFFFFF;
            color: #333333;
            cursor: pointer;
            font-family: "Make It Sans", Arial, sans-serif;
        }
        
        .btn:hover {
            background-color: #F5F5F5;
        }
        
        .btn:disabled {
            background-color: #F5F5F5;
            cursor: not-allowed;
            color: #676767;
        }
        
        .search-result {
            background-color: #F5F5F5;
            padding: 24px;
            border-radius: 6px;
            border: 1px solid #EAEAEA;
            display: none;
        }
        
        .request-form {
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }
        
        .request-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #EAEAEA;
            border-radius: 6px;
            font-size: 14px;
            min-height: 80px;
            resize: vertical;
            font-family: "Make It Sans", Arial, sans-serif;
            color: #333333;
        }
        
        .request-input:focus {
            outline: none;
            border-color: #333333;
        }
        
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #333333;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .category-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .project-count {
            background-color: #F5F5F5;
            color: #333333;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: auto;
        }
        
        .error-box {
            background-color: #FFE5E5;
            border: 1px solid #FF5555;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 32px;
        }
        
        .error-box h3 {
            color: #CC0000;
            margin-bottom: 8px;
        }
        
        .error-box p {
            color: #CC0000;
            margin-bottom: 8px;
        }
        
        @media (max-width: 768px) {
            .content-section {
                padding: 0 20px 40px 20px;
            }
            
            .title-section {
                padding: 24px 20px;
            }
            
            .title-section h1 {
                font-size: 26px;
                line-height: 36px;
            }
            
            .logo-section {
                padding: 24px 20px 0 20px;
            }
            
            .cards-grid,
            .four-column-grid {
                grid-template-columns: 1fr;
            }
            
            .request-form {
                flex-direction: column;
            }
            
            .btn {
                align-self: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="logo-section">
            <!-- Logo hier falls gewünscht -->
        </div>
        
        <div class="title-section">
            <h1>Claude-Projekt Registry</h1>
            <p>Zentrale Übersicht aller Claude-Projekte • AI-gestützte Suche • Keine doppelte Entwicklung mehr</p>
        </div>
        
        <div class="content-section">
            <div id="errorContainer"></div>
            
            <div class="four-column-grid" id="statsGrid">
                <div class="card">
                    <div class="stat-number" id="statProjects">-</div>
                    <div class="stat-label">Aktive Projekte</div>
                </div>
                <div class="card">
                    <div class="stat-number">156</div>
                    <div class="stat-label">Stunden gespart/Woche</div>
                </div>
                <div class="card">
                    <div class="stat-number" id="statTeams">-</div>
                    <div class="stat-label">Teams vernetzt</div>
                </div>
                <div class="card">
                    <div class="stat-number">12</div>
                    <div class="stat-label">Doppel-Entwicklungen verhindert</div>
                </div>
            </div>
            
            <div class="card" style="margin-bottom: 32px; background-color: #F5F5F5;">
                <h3>AI-Projekt-Suche</h3>
                <p>Beschreibe, was du brauchst - die AI findet ähnliche Projekte oder schlägt Ersteller vor.</p>
                
                <div class="search-box">
                    <input type="text" class="search-input" id="searchInput" placeholder="Beispiel: Ich brauche ein Projekt, das automatisch Social Media Posts erstellt...">
                    <button class="btn" onclick="searchProjects()">
                        <span id="searchText">Suchen</span>
                    </button>
                </div>
                
                <div class="search-result" id="searchResult">
                    <!-- AI-Suchergebnisse werden hier angezeigt -->
                </div>
            </div>
            
            <div id="projectsContainer">
                <!-- Projekte werden hier dynamisch geladen -->
            </div>
            
            <div class="card">
                <h3>Neues Projekt anfragen</h3>
                <p>Beschreibe dein Projekt-Bedürfnis - die AI schlägt geeignete Ersteller vor.</p>
                
                <div class="request-form">
                    <textarea class="request-input" id="requestInput" placeholder="Beschreibe dein Projekt-Bedürfnis...

Beispiel: Ich brauche ein Claude-Projekt, das automatisch aus unseren Produktdaten ansprechende Produktbeschreibungen für die Website erstellt. Es soll verschiedene Zielgruppen berücksichtigen und SEO-optimiert sein."></textarea>
                    <button class="btn" onclick="submitRequest()">
                        <span id="requestText">Anfrage senden</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // JSON-URL - relative URL funktioniert automatisch auf GitHub Pages
        const JSON_FILE_URL = './claude_registry_data.json';
        
        // Globale Variable für Projekt-Daten
        let projectsData = null;
        
        // Farben für Team-Badges
        const teamColors = {
            'Creative Studio': '#00FFD0',
            'Content Team': '#00FFD0',
            'B2C Marketing': '#F5F200',
            'B2B Marketing': '#F5F200',
            'UX': '#00DFFF',
            'CRM Team': '#00DFFF',
            'Analytics Team': '#FF9015',
            'Strategy Team': '#F5F200',
            'UX Research': '#00DFFF',
            'Sales Ops': '#00FFD0',
            'Operations': '#FF9015',
            'PM Office': '#00DFFF',
            'Finance': '#F5F200',
            'UX Team': '#00DFFF',
            'Market Research': '#FF9015',
            'Customer Success': '#00DFFF',
            'HR': '#F5F200',
            'Unbekannt': '#F5F5F5'
        };
        
        // Projekt-Daten beim Laden der Seite abrufen
        async function loadProjects() {
            try {
                const response = await fetch(JSON_FILE_URL);
                
                if (!response.ok) {
                    throw new Error(`Failed to fetch: ${response.status} ${response.statusText}`);
                }
                
                projectsData = await response.json();
                console.log('Projekte geladen:', projectsData);
                
                // Statistiken aktualisieren
                updateStats();
                
                // Projekte anzeigen
                renderProjects();
                
            } catch (error) {
                console.error('Fehler beim Laden der Projekt-Daten:', error);
                showError(error);
            }
        }
        
        // Fehler anzeigen
        function showError(error) {
            const errorContainer = document.getElementById('errorContainer');
            errorContainer.innerHTML = `
                <div class="error-box">
                    <h3>Fehler beim Laden der Daten</h3>
                    <p>Projekt-Daten konnten nicht geladen werden: ${error.message}</p>
                    <p>Bitte überprüfe die JSON-URL in der Konfiguration oder kontaktiere den Administrator.</p>
                </div>
            `;
        }
        
        // Statistiken aktualisieren
        function updateStats() {
            if (!projectsData || !projectsData.projects) return;
            
            // SharePoint-Projekte konvertieren
            const convertedProjects = projectsData.projects.map(convertSharePointProject);
            
            const totalProjects = convertedProjects.length;
            const uniqueTeams = new Set(convertedProjects.map(p => p.team)).size;
            
            document.getElementById('statProjects').textContent = totalProjects;
            document.getElementById('statTeams').textContent = uniqueTeams;
        }
        
        // SharePoint-Projekt zu einfacher Struktur konvertieren
        function convertSharePointProject(spProject) {
            return {
                name: spProject.Title || 'Unbenannt',
                description: spProject.Beschreibung || 'Keine Beschreibung',
                category: spProject.Kategorie && spProject.Kategorie.length > 0 
                    ? spProject.Kategorie[0].Value 
                    : 'Sonstige',
                team: spProject.Owner && spProject.Owner.Value 
                    ? spProject.Owner.Value 
                    : 'Unbekannt',
                link: spProject.Link || '',
                status: spProject.Status && spProject.Status.Value 
                    ? spProject.Status.Value 
                    : 'Unbekannt'
            };
        }
        
        // Projekte nach Kategorien gruppieren
        function groupByCategory(projects) {
            const grouped = {};
            
            projects.forEach(project => {
                const category = project.category || 'Sonstige';
                if (!grouped[category]) {
                    grouped[category] = [];
                }
                grouped[category].push(project);
            });
            
            return grouped;
        }
        
        // Projekte rendern
        function renderProjects() {
            if (!projectsData || !projectsData.projects) return;
            
            // SharePoint-Projekte konvertieren
            const convertedProjects = projectsData.projects.map(convertSharePointProject);
            
            const container = document.getElementById('projectsContainer');
            const grouped = groupByCategory(convertedProjects);
            
            let html = '<div class="cards-grid">';
            
            Object.keys(grouped).sort().forEach(category => {
                const projects = grouped[category];
                const count = projects.length;
                
                html += `
                    <div class="card">
                        <div class="category-header">
                            <h3>${category}</h3>
                            <span class="project-count">${count}</span>
                        </div>
                        <ul class="project-list">
                `;
                
                projects.forEach(project => {
                    const teamColor = teamColors[project.team] || '#F5F5F5';
                    const hasLink = project.link && project.link !== '';
                    const linkClass = hasLink ? 'style="cursor: pointer;"' : '';
                    const linkAttr = hasLink ? `data-link="${project.link}"` : '';
                    
                    html += `
                        <li class="project-item" ${linkClass} ${linkAttr}>
                            <div class="project-info">
                                <h4>${project.name}</h4>
                                <p>${project.description}</p>
                            </div>
                            <span class="project-owner" style="background-color: ${teamColor};">${project.team}</span>
                        </li>
                    `;
                });
                
                html += `
                        </ul>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
            
            // Click-Handler für Projekt-Items mit Links
            document.querySelectorAll('.project-item[data-link]').forEach(item => {
                item.addEventListener('click', function() {
                    const link = this.getAttribute('data-link');
                    if (link) {
                        window.open(link, '_blank');
                    }
                });
            });
        }
        
        async function searchProjects() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.querySelector('.btn');
            const searchText = document.getElementById('searchText');
            const searchResult = document.getElementById('searchResult');
            
            const query = searchInput.value.trim();
            
            if (!query) {
                alert('Bitte gib eine Suchanfrage ein.');
                return;
            }
            
            // Loading state
            searchBtn.disabled = true;
            searchText.innerHTML = '<span class="loading"></span>';
            searchResult.style.display = 'none';
            
            try {
                // SharePoint-Projekte konvertieren und Projektliste für AI erstellen
                let projectsList = '';
                if (projectsData && projectsData.projects) {
                    const convertedProjects = projectsData.projects.map(convertSharePointProject);
                    const grouped = groupByCategory(convertedProjects);
                    Object.keys(grouped).forEach(category => {
                        projectsList += `\n- ${category}: ${grouped[category].map(p => p.name).join(', ')}`;
                    });
                }
                
                const response = await fetch("https://api.anthropic.com/v1/messages", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        model: "claude-sonnet-4-20250514",
                        max_tokens: 500,
                        messages: [
                            {
                                role: "user",
                                content: `Du bist ein AI-Assistant für ein Claude-Projekt Registry System. 
                                
                                Analyse diese Anfrage: "${query}"
                                
                                Verfügbare Projekte:${projectsList}
                                
                                Antworte in folgendem Format:
                                
                                **Suchergebnis:**
                                
                                **Ähnliche Projekte gefunden:**
                                - [Projektname] (Owner: [Team]) - [Kurze Beschreibung]
                                
                                **Empfohlene Ansprechpartner:**
                                - [Name/Team] für [Grund]
                                
                                **Falls neu zu erstellen:**
                                Empfohlene Ersteller: [Teams] basierend auf [Begründung]
                                
                                Halte es prägnant und hilfreich!`
                            }
                        ]
                    })
                });
                
                const data = await response.json();
                const result = data.content[0].text;
                
                searchResult.innerHTML = result;
                searchResult.style.display = 'block';
                
            } catch (error) {
                searchResult.innerHTML = `
                    <strong>Demo-Suchergebnis für: "${query}"</strong><br><br>
                    
                    <strong>Ähnliche Projekte gefunden:</strong><br>
                    Suche nach Projekten in der Registry...<br><br>
                    
                    <strong>Hinweis:</strong><br>
                    AI-Suche benötigt API-Zugriff. Kontaktiere das Creative Studio Team für mehr Informationen.
                `;
                searchResult.style.display = 'block';
            }
            
            // Reset button
            searchBtn.disabled = false;
            searchText.textContent = 'Suchen';
        }
        
        async function submitRequest() {
            const requestInput = document.getElementById('requestInput');
            const requestText = document.getElementById('requestText');
            
            const request = requestInput.value.trim();
            
            if (!request) {
                alert('Bitte beschreibe dein Projekt-Bedürfnis.');
                return;
            }
            
            alert(`Anfrage gesendet!

**Demo-Analyse für dein Projekt:**

Basierend auf deiner Beschreibung empfehle ich:

**Empfohlene Teams:**
1. Content-Team - Expertise in Content-Automatisierung
2. Creative Studio - Design und User Experience  
3. Operations - Workflow-Integration

**Geschätzte Entwicklungszeit:** 2-3 Wochen

Die Teams wurden automatisch benachrichtigt und melden sich bei dir!`);
            requestInput.value = '';
        }
        
        // Enter key support for search
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchProjects();
            }
        });
        
        // Beim Laden der Seite Projekte abrufen
        window.addEventListener('DOMContentLoaded', loadProjects);
    </script>
</body>
</html>
